<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feed</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <main class="flex flex-col items-center justify-center p-8">
        <h1 class="text-2xl font-bold text-white mb-6">Feed</h1>
        <div id="posts" class="space-y-4 w-full max-w-lg"></div>
    </main>

    <script>
        const supabaseUrl = "https://pbuyszhhtmgaubzylmoh.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBidXlzemhodG1nYXVienlsbW9oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MDMyMDgsImV4cCI6MjA3NDM3OTIwOH0.EH7VsDZJWltw5c-dMkRab6-85ERhprXJ9uKAocco_jA";
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        async function loadPosts() {
            const { data, error } = await supabase
            .from("posts")
            .select("*")
            .order("created_at", { ascending: false });

            if (error) {
            console.error("Error fetching posts:", error);
            return;
            }

            const postsContainer = document.getElementById("posts");
            postsContainer.innerHTML = ""; 

            data.forEach(post => {
            const postElement = document.createElement("div");
            postElement.className = "p-4 bg-card-bg rounded-lg shadow text-white";

            postElement.innerHTML = `
                <p class="text-sm text-text-color/70 mb-2">${post.user_email}</p>
                <p class="mb-2">${post.content}</p>
                ${post.image_url ? `<img src="${post.image_url}" class="rounded-lg max-h-60"/>` : ""}
                <p class="text-xs text-text-color/50 mt-2">${new Date(post.created_at).toLocaleString()}</p>
            `;

            postsContainer.appendChild(postElement);
            });
        }

        loadPosts();
    </script>


</body>
</html>